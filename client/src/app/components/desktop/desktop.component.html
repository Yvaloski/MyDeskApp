<div class="desktop" 
     (contextmenu)="onContextMenu($event)"
     (drop)="onDrop($event)"
     (dragover)="onDragOver($event)"
     (dragleave)="onDragLeave($event)">
  
  @for (item of items; track item.id) {
    @if (item.type === 'folder') {
      <div 
        class="draggable-item"
        draggable="true"
        [attr.data-item-id]="item.id"
        (dragstart)="onDragStart($event, item)"
        (dragend)="onDragEnd($event)"
        [style.left.px]="item.x || 0"
        [style.top.px]="item.y || 0">
        <app-folder 
          [folder]="item"
          (moved)="onItemMoved($event)"
          (contextmenu)="onContextMenu($event, item)"
          (dblclick)="openItem(item)"
          (dropItem)="onDrop($event)"
          (dragOver)="onDragOver($event)"
          (dragEnter)="onDragOver($event)"
          (dragLeave)="onDragLeave($event)">
        </app-folder>
      </div>
    } @else {
      <div 
        class="draggable-item"
        draggable="true"
        [attr.data-item-id]="item.id"
        (dragstart)="onDragStart($event, item)"
        (dragend)="onDragEnd($event)"
        [style.left.px]="item.x || 0"
        [style.top.px]="item.y || 0">
        <app-file 
          [file]="item"
          (moved)="onItemMoved($event)"
          (contextmenu)="onContextMenu($event, item)"
          (dblclick)="openItem(item)">
        </app-file>
      </div>
    }
  }
</div>

@if (showContextMenu) {
  <app-context-menu
    [x]="contextMenuX"
    [y]="contextMenuY"
    [target]="contextMenuTarget"
    (action)="onContextMenuAction($event)"
    (close)="showContextMenu = false">
  </app-context-menu>
}

@if (showFileExplorer) {
  <app-file-explorer
    [path]="fileExplorerPath"
    (close)="onFileExplorerClose()">
  </app-file-explorer>
}
